# 消息系统 PRD / Message System PRD

## 功能概述
实现用户之间的私信功能，支持会话列表、聊天记录、消息发送和未读提醒。

## 用户故事
1. 用户可以查看所有私信会话列表
2. 用户可以与好友进行私信聊天
3. 用户可以看到未读消息数量
4. 用户发送消息后立即看到（乐观更新）

## 功能需求

### P0 核心功能
- 会话列表：显示所有聊天会话，按最新消息时间排序
- 聊天记录：查看与某人的历史消息
- 发送私信：只能给好友发送私信
- 未读提醒：显示未读消息数量
- 敏感词过滤：消息内容需过滤敏感词

### P1 体验优化
- 乐观更新：发送消息后立即显示
- 短轮询：每5秒检查新消息
- 标记已读：进入聊天页面自动标记已读

## 业务规则
1. 只能给好友发送私信
2. 被拉黑后无法发送私信
3. 消息内容最长1000字
4. 消息需要敏感词过滤

## API 接口

| 接口 | 方法 | 说明 |
|------|------|------|
| /messages/conversations/ | GET | 会话列表 |
| /messages/conversations/{id}/messages/ | GET | 聊天记录 |
| /messages/send/ | POST | 发送私信 |
| /messages/conversations/{id}/read/ | POST | 标记已读 |
| /messages/unread-count/ | GET | 未读数 |
| /messages/updates/ | GET | 轮询更新 |
