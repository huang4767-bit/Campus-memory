# Campus Memory 开发流程

> 本文档将项目拆解为 5 个阶段、15 个模块，按依赖关系排序

---

## 一、阶段概览

| 阶段 | 名称 | 模块数 | 说明 |
|------|------|--------|------|
| 阶段一 | 基础框架 | 3 | 项目地基，后续所有功能依赖此阶段 |
| 阶段二 | 用户与学校 | 3 | 用户注册登录后的信息完善流程 |
| 阶段三 | 话题圈与帖子 | 4 | MVP 核心功能 |
| 阶段四 | 社交连接 | 3 | 好友与消息系统 |
| 阶段五 | 增值与完善 | 2 | 相册、举报、管理后台 |

---

## 二、详细模块拆解

### 阶段一：基础框架

#### 1.1 后端初始化
- [ ] 创建 Django 项目结构
- [ ] 配置 PostgreSQL 数据库连接
- [ ] 集成 Django REST Framework
- [ ] 配置 CORS 跨域
- [ ] 创建 common 公共模块（统一响应、分页、异常处理）

**产出：** 能运行的 Django 空项目

#### 1.2 前端初始化
- [ ] 使用 Vite 创建 React 项目
- [ ] 安装配置 Ant Design 5.x
- [ ] 配置 React Router 路由
- [ ] 封装 Axios 请求实例
- [ ] 配置 Zustand 状态管理
- [ ] 创建基础目录结构

**产出：** 能运行的 React 空项目

#### 1.3 认证系统
- [ ] 配置 JWT 认证（djangorestframework-simplejwt）
- [ ] 实现用户注册接口
- [ ] 实现用户登录接口
- [ ] 实现 Token 刷新接口
- [ ] 实现登录失败锁定逻辑（5次失败锁定15分钟）
- [ ] 前端登录页面
- [ ] 前端注册页面
- [ ] 前端 Token 存储与自动刷新

**产出：** 完整的认证流程

---

### 阶段二：用户与学校

#### 2.1 学校模块
- [ ] 创建 School 模型
- [ ] 学校列表接口（支持搜索）
- [ ] 添加学校接口
- [ ] 学校详情接口

**产出：** 学校数据管理

#### 2.2 用户信息模块
- [ ] 创建 UserProfile 模型
- [ ] 完善用户信息接口
- [ ] 获取当前用户信息接口
- [ ] 更新个人信息接口
- [ ] 查看他人主页接口（含隐私控制）
- [ ] 头像上传功能
- [ ] 用户注销接口（软删除+脱敏）

**产出：** 用户资料管理

#### 2.3 前端用户页面
- [ ] 完善信息页面（选择学校、填写班级等）
- [ ] 个人主页页面
- [ ] 编辑资料页面
- [ ] 他人主页页面

**产出：** 完整用户信息流程

---

### 阶段三：话题圈与帖子

#### 3.1 话题圈模块
- [ ] 创建 Circle 模型
- [ ] 创建 CircleMember 模型
- [ ] 自动入圈逻辑（用户完善信息后自动加入校级圈、年级圈）
- [ ] 创建班级圈接口
- [ ] 申请加入班级圈接口
- [ ] 审核入圈申请接口（通过/拒绝）
- [ ] 圈子列表接口
- [ ] 圈子详情接口
- [ ] 圈子成员列表接口

**产出：** 三级话题圈系统

#### 3.2 帖子模块
- [ ] 创建 Post 模型
- [ ] 敏感词过滤功能
- [ ] 图片上传接口
- [ ] 发布帖子接口
- [ ] 帖子列表接口（支持排序：最新/最热）
- [ ] 帖子详情接口
- [ ] 编辑帖子接口
- [ ] 删除帖子接口（软删除）
- [ ] 置顶/精华接口（管理员）

**产出：** 帖子发布与管理

#### 3.3 互动模块
- [ ] 创建 Comment 模型（支持楼中楼）
- [ ] 创建 Like 模型
- [ ] 创建 Favorite 模型
- [ ] 发表评论接口
- [ ] 回复评论接口（楼中楼）
- [ ] 评论列表接口
- [ ] 删除评论接口
- [ ] 点赞/取消点赞接口（帖子）
- [ ] 点赞/取消点赞接口（评论）
- [ ] 收藏/取消收藏接口
- [ ] 我的收藏列表接口

**产出：** 完整互动功能

#### 3.4 前端圈子帖子页面
- [ ] 首页动态流（已加入圈子的帖子）
- [ ] 圈子列表页面
- [ ] 圈子详情页面（帖子列表+成员管理）
- [ ] 发帖页面（富文本+图片上传）
- [ ] 帖子详情页面
- [ ] 评论组件（支持楼中楼）
- [ ] 入圈申请管理页面（管理员）

**产出：** 完整内容浏览体验

---

### 阶段四：社交连接

#### 4.1 好友系统
- [ ] 创建 Friendship 模型
- [ ] 发送好友请求接口
- [ ] 好友请求列表接口
- [ ] 接受好友请求接口
- [ ] 拒绝好友请求接口
- [ ] 好友列表接口
- [ ] 删除好友接口
- [ ] 校友搜索接口

**产出：** 好友关系管理

#### 4.2 消息系统
- [ ] 创建 PrivateMessage 模型
- [ ] 发送私信接口
- [ ] 私信会话列表接口
- [ ] 私信记录接口（与某人的聊天）
- [ ] 标记已读接口
- [ ] 未读消息数接口
- [ ] 短轮询实现（前端每5秒请求）

**产出：** 私信功能

#### 4.3 前端社交页面
- [ ] 好友列表页面
- [ ] 好友请求页面
- [ ] 校友搜索页面
- [ ] 消息中心页面
- [ ] 私信聊天页面

**产出：** 社交功能界面

---

### 阶段五：增值与完善

#### 5.1 相册与举报模块
- [ ] 创建 AlbumPhoto 模型
- [ ] 上传照片接口
- [ ] 相册列表接口
- [ ] 删除照片接口
- [ ] 创建 Report 模型
- [ ] 提交举报接口
- [ ] 举报列表接口（管理员）
- [ ] 处理举报接口（管理员）

**产出：** 班级云相册 + 举报系统

#### 5.2 管理后台与部署
- [ ] Django Admin 配置（用户管理、内容管理）
- [ ] 管理员删除内容接口
- [ ] 前端管理页面（可选，或直接用 Django Admin）
- [ ] Docker 容器化
- [ ] Nginx 配置
- [ ] 数据库备份脚本

**产出：** 可部署的完整系统

---

## 三、模块依赖关系

```
1.1 后端初始化 ──┬──► 1.3 认证系统 ──► 2.1 学校模块 ──► 2.2 用户信息模块
1.2 前端初始化 ──┘                                            │
                                                              ▼
                                                    3.1 话题圈模块
                                                         │
                                              ┌──────────┼──────────┐
                                              ▼          ▼          ▼
                                        3.2 帖子模块  5.1 相册    4.1 好友系统
                                              │                      │
                                              ▼                      ▼
                                        3.3 互动模块           4.2 消息系统
```

---

## 四、开发检查点

### MVP 完成标准（阶段一 ~ 阶段三）
- [ ] 用户可以注册、登录
- [ ] 用户可以完善校友信息
- [ ] 用户自动加入校级圈、年级圈
- [ ] 用户可以创建/申请加入班级圈
- [ ] 用户可以发帖、评论、点赞、收藏
- [ ] 首页可以看到已加入圈子的动态

### 完整版完成标准（全部阶段）
- [ ] MVP 全部功能
- [ ] 好友系统正常运作
- [ ] 私信功能可用
- [ ] 班级相册可用
- [ ] 举报功能可用
- [ ] 管理后台可用

---

## 五、建议开发顺序

1. **1.1 + 1.2** 可并行开发（前后端初始化互不依赖）
2. **1.3 认证系统** 前后端联调
3. **2.1 → 2.2 → 2.3** 顺序开发
4. **3.1 → 3.2 → 3.3** 顺序开发，**3.4** 可与后端并行
5. **4.1 → 4.2 → 4.3** 顺序开发
6. **5.1 → 5.2** 根据时间安排
